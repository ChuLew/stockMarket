{"ast":null,"code":"import _classCallCheck from\"/Users/mitchlew/Documents/Streaming/streams/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/mitchlew/Documents/Streaming/streams/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/mitchlew/Documents/Streaming/streams/client/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/mitchlew/Documents/Streaming/streams/client/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import flv from'flv.js';import{connect}from'react-redux';import{fetchStream}from'../../actions';var StreamShow=/*#__PURE__*/function(_React$Component){_inherits(StreamShow,_React$Component);var _super=_createSuper(StreamShow);function StreamShow(props){var _this;_classCallCheck(this,StreamShow);_this=_super.call(this,props);_this.videoRef=React.createRef();return _this;}_createClass(StreamShow,[{key:\"componentDidMount\",value:function componentDidMount(){var id=this.props.match.params.id;this.props.fetchStream(id);this.buildPlayer();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.buildPlayer();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.player.destroy();}},{key:\"buildPlayer\",value:function buildPlayer(){if(this.player||!this.props.stream){return;}var id=this.props.match.params.id;this.player=flv.createPlayer({type:'flv',url:\"http://localhost:8000/live/\".concat(id,\".flv\")});this.player.attachMediaElement(this.videoRef.current);this.player.load();}},{key:\"render\",value:function render(){if(!this.props.stream){return/*#__PURE__*/React.createElement(\"div\",null,\"Loading...\");}var _this$props$stream=this.props.stream,title=_this$props$stream.title,description=_this$props$stream.description;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"video\",{ref:this.videoRef,style:{width:'100%'},controls:true}),/*#__PURE__*/React.createElement(\"h1\",null,title),/*#__PURE__*/React.createElement(\"h5\",null,description));}}]);return StreamShow;}(React.Component);var mapStateToProps=function mapStateToProps(state,ownProps){return{stream:state.streams[ownProps.match.params.id]};};export default connect(mapStateToProps,{fetchStream:fetchStream})(StreamShow);","map":{"version":3,"sources":["/Users/mitchlew/Documents/Streaming/streams/client/src/components/streams/StreamShow.js"],"names":["React","flv","connect","fetchStream","StreamShow","props","videoRef","createRef","id","match","params","buildPlayer","player","destroy","stream","createPlayer","type","url","attachMediaElement","current","load","title","description","width","Component","mapStateToProps","state","ownProps","streams"],"mappings":"ogBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,GAAP,KAAgB,QAAhB,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,WAAT,KAA4B,eAA5B,C,GAEMC,CAAAA,U,oHACJ,oBAAYC,KAAZ,CAAmB,4CACjB,uBAAMA,KAAN,EAEA,MAAKC,QAAL,CAAgBN,KAAK,CAACO,SAAN,EAAhB,CAHiB,aAIlB,C,oFAEmB,IACVC,CAAAA,EADU,CACH,KAAKH,KAAL,CAAWI,KAAX,CAAiBC,MADd,CACVF,EADU,CAGlB,KAAKH,KAAL,CAAWF,WAAX,CAAuBK,EAAvB,EACA,KAAKG,WAAL,GACD,C,+DAEoB,CACnB,KAAKA,WAAL,GACD,C,mEAEsB,CACrB,KAAKC,MAAL,CAAYC,OAAZ,GACD,C,iDAEa,CACZ,GAAI,KAAKD,MAAL,EAAe,CAAC,KAAKP,KAAL,CAAWS,MAA/B,CAAuC,CACrC,OACD,CAHW,GAKJN,CAAAA,EALI,CAKG,KAAKH,KAAL,CAAWI,KAAX,CAAiBC,MALpB,CAKJF,EALI,CAMZ,KAAKI,MAAL,CAAcX,GAAG,CAACc,YAAJ,CAAiB,CAC7BC,IAAI,CAAE,KADuB,CAE7BC,GAAG,sCAAgCT,EAAhC,QAF0B,CAAjB,CAAd,CAIA,KAAKI,MAAL,CAAYM,kBAAZ,CAA+B,KAAKZ,QAAL,CAAca,OAA7C,EACA,KAAKP,MAAL,CAAYQ,IAAZ,GACD,C,uCAEQ,CACP,GAAI,CAAC,KAAKf,KAAL,CAAWS,MAAhB,CAAwB,CACtB,mBAAO,4CAAP,CACD,CAHM,uBAKwB,KAAKT,KAAL,CAAWS,MALnC,CAKCO,KALD,oBAKCA,KALD,CAKQC,WALR,oBAKQA,WALR,CAOP,mBACE,4CACE,6BAAO,GAAG,CAAE,KAAKhB,QAAjB,CAA2B,KAAK,CAAE,CAAEiB,KAAK,CAAE,MAAT,CAAlC,CAAqD,QAAQ,KAA7D,EADF,cAEE,8BAAKF,KAAL,CAFF,cAGE,8BAAKC,WAAL,CAHF,CADF,CAOD,C,wBAlDsBtB,KAAK,CAACwB,S,EAqD/B,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,KAAD,CAAQC,QAAR,CAAqB,CAC3C,MAAO,CAAEb,MAAM,CAAEY,KAAK,CAACE,OAAN,CAAcD,QAAQ,CAAClB,KAAT,CAAeC,MAAf,CAAsBF,EAApC,CAAV,CAAP,CACD,CAFD,CAIA,cAAeN,CAAAA,OAAO,CACpBuB,eADoB,CAEpB,CAAEtB,WAAW,CAAXA,WAAF,CAFoB,CAAP,CAGbC,UAHa,CAAf","sourcesContent":["import React from 'react';\nimport flv from 'flv.js';\nimport { connect } from 'react-redux';\nimport { fetchStream } from '../../actions';\n\nclass StreamShow extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.videoRef = React.createRef();\n  }\n\n  componentDidMount() {\n    const { id } = this.props.match.params;\n\n    this.props.fetchStream(id);\n    this.buildPlayer();\n  }\n\n  componentDidUpdate() {\n    this.buildPlayer();\n  }\n\n  componentWillUnmount() {\n    this.player.destroy();\n  }\n\n  buildPlayer() {\n    if (this.player || !this.props.stream) {\n      return;\n    }\n\n    const { id } = this.props.match.params;\n    this.player = flv.createPlayer({\n      type: 'flv',\n      url: `http://localhost:8000/live/${id}.flv`\n    });\n    this.player.attachMediaElement(this.videoRef.current);\n    this.player.load();\n  }\n\n  render() {\n    if (!this.props.stream) {\n      return <div>Loading...</div>;\n    }\n\n    const { title, description } = this.props.stream;\n\n    return (\n      <div>\n        <video ref={this.videoRef} style={{ width: '100%' }} controls />\n        <h1>{title}</h1>\n        <h5>{description}</h5>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return { stream: state.streams[ownProps.match.params.id] };\n};\n\nexport default connect(\n  mapStateToProps,\n  { fetchStream }\n)(StreamShow);\n"]},"metadata":{},"sourceType":"module"}